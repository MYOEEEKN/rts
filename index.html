<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEROX X AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=El+Messiri:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js"></script>
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
    <style>
        /* Premium Palette: SEROX X AI (Purple + White) */
        body {
            font-family: 'El Messiri', sans-serif;
            background: linear-gradient(135deg, #2C1D3C, #8E44AD); /* Very Dark Purple to Wisteria Purple */
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            margin: 0;
            padding: 0;
            color: #FFFFFF; /* Global white text color */
        }
        * {
            color: #FFFFFF;
        }
        .popup, .modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(44, 29, 60, 0.95);
            padding: 1.5rem;
            border-radius: 1.5rem;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.35);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            z-index: 1000;
            width: 90%;
            max-width: 450px;
            border: 1px solid rgba(142, 68, 173, 0.5);
        }
        .popup.active, .modal.active {
            display: block;
        }
        .card {
            transition: all 0.3s ease;
            background: rgba(44, 29, 60, 0.85);
            border-radius: 1.5rem;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            position: relative;
            margin: 0.75rem;
            overflow: hidden;
            border: 1px solid rgba(26, 17, 35, 0.5);
        }
        .card:hover {
            transform: translateY(-6px) scale(1.03);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        .gradient-bg {
            background: linear-gradient(135deg, #1A1123, #8E44AD);
        }
        svg {
            width: 100%;
            height: auto;
            margin: 0 auto;
            display: block;
        }
        svg text {
            text-anchor: middle;
            dominant-baseline: middle;
            text-transform: uppercase;
            animation: stroke 5s infinite alternate;
            stroke-width: 1.2;
            stroke: #BB8FCE;
            font-size: 130px;
            fill: rgba(44, 29, 60, 0);
        }
        @media (max-width: 768px) {
            svg text { font-size: 90px; }
        }
        @keyframes stroke {
            0%   { fill: rgba(44, 29, 60, 0); stroke: #BB8FCE; stroke-dashoffset: 25%; stroke-dasharray: 0 50%; stroke-width: 1.2; }
            70%  { fill: rgba(44, 29, 60, 0); stroke: #D91B5C; }
            80%  { fill: rgba(44, 29, 60, 0); stroke: #FFFFFF; stroke-width: 2.5; }
            100% { fill: #2C1D3C; stroke: rgba(44, 29, 60, 0); stroke-dashoffset: -25%; stroke-dasharray: 50% 0; stroke-width: 0; }
        }
        .history-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            max-height: none;
            overflow: visible;
            position: relative;
        }
        .history-item {
            transition: all 0.3s ease;
            width: 100%;
            max-width: 100%;
            margin: 0;
            border-radius: 1.2rem;
            background: rgba(44, 29, 60, 0.8);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            box-shadow: 0 4px 14px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
            padding: 1.2rem;
            border-left: 4px solid transparent;
        }
        .history-item.win { border-left-color: #2ECC71; background: linear-gradient(135deg, rgba(46, 204, 113, 0.2), rgba(44, 29, 60, 0.8)); }
        .history-item.loss { border-left-color: #E74C3C; background: linear-gradient(135deg, rgba(231, 76, 60, 0.2), rgba(44, 29, 60, 0.8)); }
        .history-item.pending { border-left-color: #F1C40F; background: linear-gradient(135deg, rgba(241, 196, 15, 0.2), rgba(44, 29, 60, 0.8)); }
        .history-item.skipped { border-left-color: #9B59B6; background: linear-gradient(135deg, rgba(155, 89, 182, 0.2), rgba(44, 29, 60, 0.8)); }
        .history-item:hover { transform: scale(1.02); box-shadow: 0 6px 18px rgba(0, 0, 0, 0.3); }
        .history-item.fade-out { animation: fadeOut 0.5s ease forwards; }
        @keyframes fadeOut {
            0% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(0.95); height: 0; padding: 0; margin: 0; }
        }
        .delete-btn:hover { color: #D91B5C; transform: scale(1.3); }
        .win-badge { background: rgba(46, 204, 113, 0.25); color: #27AE60; }
        .loss-badge { background: rgba(231, 76, 60, 0.25); color: #C0392B; }
        .pending-badge { background: rgba(241, 196, 15, 0.25); color: #F39C12; }
        .status-icon {
            width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 18px; position: relative; overflow: hidden;
        }
        .win-icon { color: #2ECC71; animation: pulseWin 1.5s infinite; }
        .loss-icon { color: #E74C3C; animation: pulseLoss 1s infinite; }
        .pending-icon { color: #F1C40F; animation: rotate 2s infinite linear; }
        @keyframes pulseWin {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(46, 204, 113, 0.4); }
            70% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(46, 204, 113, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(46, 204, 113, 0); }
        }
        @keyframes pulseLoss { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .dashboard-card {
            background: rgba(44, 29, 60, 0.85);
            border-radius: 1.5rem; padding: 1.2rem; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); transition: all 0.3s ease; border: 1px solid rgba(26, 17, 35, 0.4);
        }
        .dashboard-card:hover { transform: translateY(-4px); box-shadow: 0 6px 14px rgba(0, 0, 0, 0.3); }
        .confidence-meter { height: 10px; background: #1A1123; border-radius: 5px; overflow: hidden; position: relative; }
        .confidence-fill { height: 100%; background: #8E44AD; transition: width 0.5s ease; }
        .navigation {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); width: 350px; height: 70px; background: rgba(26, 17, 35, 0.92); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); display: flex; justify-content: center; align-items: center; border-radius: 1.5rem; box-shadow: 0 6px 12px rgba(0, 0, 0, 0.35); z-index: 1000; border: 1px solid rgba(142, 68, 173, 0.3);
        }
        .navigation ul { display: flex; width: 300px; }
        .navigation ul li { position: relative; list-style: none; width: 75px; height: 70px; z-index: 1; }
        .navigation ul li a { position: relative; display: flex; justify-content: center; align-items: center; flex-direction: column; width: 100%; text-align: center; font-weight: 500; }
        .navigation ul li a .icon { position: relative; display: block; line-height: 75px; font-size: 1.5em; text-align: center; transition: 0.5s; color: #FFFFFF; }
        .navigation ul li.active a .icon { transform: translateY(-32px); color: #FFFFFF; }
        .navigation ul li a .text { position: absolute; font-weight: 400; font-size: 0.75em; letter-spacing: 0.05em; transition: 0.5s; opacity: 0; transform: translateY(20px); color: #FFFFFF; }
        .navigation ul li.active a .text { opacity: 1; transform: translateY(10px); }
        .indicator { position: absolute; top: -50%; width: 70px; height: 70px; background: #D91B5C; border-radius: 50%; border: 6px solid #2C1D3C; transition: 0.5s; }
        .indicator::before { content: ''; position: absolute; top: 50%; left: -22px; width: 20px; height: 20px; background: transparent; border-top-right-radius: 20px; box-shadow: 1px -10px 0 0 #2C1D3C; }
        .indicator::after { content: ''; position: absolute; top: 50%; right: -22px; width: 20px; height: 20px; background: transparent; border-top-left-radius: 20px; box-shadow: -1px -10px 0 0 #2C1D3C; }
        .navigation ul li:nth-child(1).active ~ .indicator { transform: translateX(calc(75px * 0)); }
        .navigation ul li:nth-child(2).active ~ .indicator { transform: translateX(calc(75px * 1)); }
        .navigation ul li:nth-child(3).active ~ .indicator { transform: translateX(calc(75px * 2)); }
        .navigation ul li:nth-child(4).active ~ .indicator { transform: translateX(calc(75px * 3)); }
        
        .content-section { display: none; padding: 1rem; }
        .content-section.active { display: block; }
        
        .period-id { font-family: monospace; letter-spacing: 2px; font-size: 1.2rem; }
        #currentPeriod, #currentResult { border: none !important; background-color: rgba(26, 17, 35, 0.7) !important; color: #FFFFFF !important; }

        button, .btn {
            border-radius: 1rem; background: rgba(217, 27, 92, 0.9); color: #FFFFFF; backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); transition: all 0.3s ease; padding: 0.5rem 1rem; font-weight: 500; border: 1px solid rgba(217, 27, 92, 0.5);
        }
        button:hover, .btn:hover { background: #A91548; transform: scale(1.05); box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
        .bg-90EE90 { background-color: #2ECC71 !important; }
        
        .text-win-icon { color: #2ECC71 !important; }
        .text-loss-icon { color: #E74C3C !important; }
        .text-pending-icon { color: #F1C40F !important; }
        .text-accent-icon { color: #D91B5C !important; }
        .text-primary-accent-icon { color: #8E44AD !important; }

        .btn-cancel {
            background: #8E44AD; color: #FFFFFF; border-color: rgba(142, 68, 173, 0.5);
        }
        .btn-cancel:hover { background: #9B59B6; }

        @media (max-width: 768px) {
            .card { padding: 0.75rem; margin: 0.5rem; border-radius: 1rem; }
            .grid-cols-2 { grid-template-columns: 1fr; }
            .md\\:grid-cols-3 { grid-template-columns: 1fr 1fr; }
            .text-4xl { font-size: 2rem; } .text-2xl { font-size: 1.25rem; }
            .p-6 { padding: 1rem; }
            .history-item { padding: 1rem; border-radius: 1rem; }
            .navigation { width: 300px; border-radius: 1rem; }
            .navigation ul { width: 250px; }
            .navigation ul li { width: 62.5px; }
            .indicator { width: 60px; height: 60px; }
            .navigation ul li:nth-child(1).active ~ .indicator { transform: translateX(calc(62.5px * 0)); }
            .navigation ul li:nth-child(2).active ~ .indicator { transform: translateX(calc(62.5px * 1)); }
            .navigation ul li:nth-child(3).active ~ .indicator { transform: translateX(calc(62.5px * 2)); }
            .navigation ul li:nth-child(4).active ~ .indicator { transform: translateX(calc(62.5px * 3)); }
            .popup, .modal { max-width: 320px; padding: 1rem; border-radius: 1rem; }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">
    <div class="w-full relative pb-20">
        <header class="text-center mt-0 mb-2 animate__animated animate__fadeInDown">
            <svg viewBox="0 0 800 120">
                <text x="50%" y="50%">SEROX X AI</text>
            </svg>
        </header>

        <div class="max-w-full mx-auto w-full">
            <div class="max-w-4xl mx-auto w-full">
                <div id="homeSection" class="content-section active">
                    <div class="space-y-6 p-4">
                        <div class="card !m-0 gradient-bg animate__animated animate__zoomIn relative">
                            <div class="p-6 rounded-lg">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-center">
                                    <div class="text-center md:text-left">
                                        <div class="flex items-center justify-center md:justify-start space-x-2 mb-2">
                                            <i class="fas fa-calendar-alt text-2xl text-primary-accent-icon"></i>
                                            <h2 class="text-2xl font-bold" data-lang-key="period">Period</h2>
                                        </div>
                                        <p id="currentPeriod" class="text-4xl font-semibold p-3 rounded-lg shadow-inner period-id">-</p>
                                    </div>
                                    <div class="text-center md:text-right">
                                        <div class="flex items-center justify-center md:justify-end space-x-2 mb-2">
                                            <h2 class="text-2xl font-bold" data-lang-key="prediction">Prediction</h2>
                                            <i class="fas fa-poll text-2xl text-primary-accent-icon"></i>
                                        </div>
                                        <p id="currentResult" class="text-4xl font-bold p-3 rounded-lg shadow-inner">-</p>
                                    </div>
                                </div>
                                <div class="mt-6">
                                    <p class="text-sm text-center" data-lang-key="confidence">Confidence</p>
                                    <div class="confidence-meter mt-1">
                                        <div id="confidenceFill" class="confidence-fill" style="width: 0%"></div>
                                    </div>
                                    <p id="confidenceText" class="text-lg font-bold text-center mt-1">0%</p>
                                </div>
                            </div>
                        </div>

                        <div class="card !m-0 p-6 animate__animated animate__fadeInUp">
                             <div class="flex items-center gap-4 mb-4">
                                <i class="fas fa-tachometer-alt text-3xl text-accent-icon"></i>
                                <h2 class="text-2xl font-bold" data-lang-key="analysis_dashboard">Analysis Dashboard</h2>
                            </div>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                               <div class="dashboard-card">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-percentage text-2xl text-accent-icon"></i>
                                        <div>
                                            <p class="text-sm opacity-80" data-lang-key="win_rate">Win Rate</p>
                                            <p id="winRate" class="text-xl font-bold">-</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="dashboard-card">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-trophy text-2xl text-win-icon"></i>
                                        <div>
                                            <p class="text-sm opacity-80" data-lang-key="wins">Wins</p>
                                            <p id="totalWinBets" class="text-xl font-bold">-</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="dashboard-card">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-skull text-2xl text-loss-icon"></i>
                                        <div>
                                            <p class="text-sm opacity-80" data-lang-key="losses">Losses</p>
                                            <p id="totalLossBets" class="text-xl font-bold">-</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="dashboard-card flex items-center justify-between">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-server text-2xl text-primary-accent-icon"></i>
                                        <div>
                                            <p class="text-sm opacity-80" data-lang-key="server_status">Server Status</p>
                                            <p id="serverStatus" class="font-semibold" data-lang-key="connected">Connected</p>
                                        </div>
                                    </div>
                                    <div id="serverStatusIndicator" class="w-3 h-3 bg-90EE90 rounded-full animate-ping"></div>
                                </div>
                                 <div class="dashboard-card">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-brain text-2xl text-primary-accent-icon"></i>
                                        <div>
                                            <p class="text-sm opacity-80" data-lang-key="current_logic">Current Logic</p>
                                            <p id="currentLogicDisplay" class="text-xl font-bold">-</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="historySection" class="content-section">
                    <div class="card p-6 animate__animated animate__fadeInUp relative !m-4">
                        <div class="flex justify-between items-center mb-4">
                             <div class="flex items-center gap-4">
                                <i class="fas fa-history text-3xl text-accent-icon"></i>
                                <h2 class="text-2xl font-bold" data-lang-key="history">History</h2>
                            </div>
                            <button id="deleteAllHistoryBtn" class="btn px-4 py-2 rounded-lg flex items-center">
                                <i class="fas fa-trash-alt mr-2"></i><span data-lang-key="delete">Delete</span>
                            </button>
                        </div>
                        <div id="history" class="history-container space-y-4"></div>
                    </div>
                </div>

                <div id="statsSection" class="content-section">
                     <div class="card p-6 animate__animated animate__fadeInUp relative !m-4">
                        <div class="flex items-center gap-4 mb-4">
                            <i class="fas fa-chart-pie text-3xl text-accent-icon"></i>
                            <h2 class="text-2xl font-bold" data-lang-key="statistics">Statistics</h2>
                        </div>
                        <div id="recentResultsContainer" class="flex flex-wrap gap-2 justify-center mb-4">
                           <!-- Recent results will be injected here -->
                        </div>
                        <div class="grid grid-cols-2 md:grid-cols-2 gap-4">
                            <div class="dashboard-card text-center">
                                <i class="fas fa-trophy text-4xl text-win-icon mx-auto mb-2"></i>
                                <p class="text-sm opacity-80" data-lang-key="total_wins">Total Wins</p>
                                <p id="statsTotalWins" class="text-2xl font-bold mt-1">-</p>
                            </div>
                            <div class="dashboard-card text-center">
                                <i class="fas fa-skull text-4xl text-loss-icon mx-auto mb-2"></i>
                                <p class="text-sm opacity-80" data-lang-key="total_losses">Total Losses</p>
                                <p id="statsTotalLosses" class="text-2xl font-bold mt-1">-</p>
                            </div>
                            <div class="dashboard-card text-center col-span-2">
                                <i class="fas fa-percentage text-4xl text-pending-icon mx-auto mb-2"></i>
                                <p class="text-sm opacity-80" data-lang-key="win_rate">Win Rate</p>
                                <p id="statsWinRate" class="text-2xl font-bold mt-1">-</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="aboutSection" class="content-section">
                    <div class="p-4 space-y-6">
                       <div class="card p-6 animate__animated animate__fadeInUp !m-0">
                             <div class="flex items-center gap-4 mb-4">
                                <i class="fas fa-cogs text-3xl text-primary-accent-icon"></i>
                                <h3 class="text-2xl font-semibold" data-lang-key="predictor_intro_title">Our Prediction Engine</h3>
                            </div>
                            <p data-lang-key="predictor_intro_p1">
                                SEROX X AI employs a sophisticated prediction engine designed to analyze trends and patterns from historical data. Our goal is to provide insightful predictions, but it's important to remember that these are based on statistical analysis and not guarantees of future outcomes.
                            </p>
                        </div>
                        
                        <div class="card p-6 animate__animated animate__fadeInUp !m-0" style="animation-delay: 0.2s;">
                           <div class="flex items-center gap-4 mb-4">
                                <i class="fas fa-users text-3xl text-primary-accent-icon"></i>
                                <h3 class="text-2xl font-semibold" data-lang-key="meet_the_team_title">Meet The Team</h3>
                            </div>
                            <p data-lang-key="owner_dev_info"><strong>Owner & Developer:</strong> @SEROXAI</p>
                            <p class="flex items-center mt-2">
                                <i class="fab fa-telegram text-primary-accent-icon mr-2"></i>
                                <a href="https://t.me/SEROXAI" target="_blank" class="text-link" data-lang-key="contact_telegram">Telegram Profile</a>
                            </p>
                        </div>

                         <div class="card p-6 animate__animated animate__fadeInUp flex flex-col sm:flex-row justify-between items-center gap-4 !m-0" style="animation-delay: 0.4s;">
                            <div class="flex items-center gap-4">
                                 <i class="fas fa-shield-alt text-3xl text-accent-icon"></i>
                                 <div>
                                    <h3 class="text-xl font-semibold" data-lang-key="privacy_policy_title">Privacy Policy & Disclaimer</h3>
                                    <p class="text-sm opacity-80" data-lang-key="review_terms">Review our terms and data policies.</p>
                                </div>
                            </div>
                            <button id="privacyBtn" class="btn shrink-0">
                                <span data-lang-key="view_policy">View Policy</span> <i class="fas fa-arrow-right ml-2"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="navigation">
            <ul>
                <li class="active">
                    <a href="#" data-section="homeSection">
                        <span class="icon"><ion-icon name="home-outline"></ion-icon></span>
                        <span class="text" data-lang-key="home">Home</span>
                    </a>
                </li>
                <li>
                    <a href="#" data-section="historySection">
                        <span class="icon"><ion-icon name="time-outline"></ion-icon></span>
                        <span class="text" data-lang-key="history">History</span>
                    </a>
                </li>
                <li>
                    <a href="#" data-section="statsSection">
                        <span class="icon"><ion-icon name="bar-chart-outline"></ion-icon></span>
                        <span class="text" data-lang-key="stats">Stats</span>
                    </a>
                </li>
                <li>
                    <a href="#" data-section="aboutSection">
                        <span class="icon"><ion-icon name="information-circle-outline"></ion-icon></span>
                        <span class="text" data-lang-key="about">About</span>
                    </a>
                </li>
                <div class="indicator"></div>
            </ul>
        </div>

        <div id="privacyModal" class="modal">
            <div class="flex justify-between items-center mb-4">
                 <h3 class="text-xl font-semibold" data-lang-key="privacy_policy_title">Privacy Policy & Disclaimer</h3>
                 <button id="closePrivacyModalBtn" class="hover:text-D91B5C transition text-2xl">&times;</button>
            </div>
            <div class="space-y-3 text-sm max-h-[60vh] overflow-y-auto pr-2">
                <p data-lang-key="privacy_policy_p1">
                    <strong>1. Data Collection:</strong> We do not collect, store, or share any personal user data. All settings and history are stored locally on your device's browser. Clearing your browser's cache will permanently delete this information.
                </p>
                <p data-lang-key="privacy_policy_p2">
                    <strong>2. Use of Predictions:</strong> The predictions generated by SEROX X AI are for informational and entertainment purposes only. They are based on algorithmic analysis of historical data and are not guaranteed to be accurate.
                </p>
                <p data-lang-key="privacy_policy_p3">
                    <strong>3. Financial Risk:</strong> We are not responsible for any financial losses incurred as a result of using our predictions. The user assumes full responsibility for any actions taken based on the information provided by this tool. Past performance is not an indicator of future results.
                </p>
                <p data-lang-key="privacy_policy_p4">
                    <strong>4. Responsible Use:</strong> Please use this tool responsibly and be aware of the risks involved. Do not use this tool for any illegal activities.
                </p>
            </div>
        </div>

        <div id="confirmModal" class="modal">
            <h3 class="text-lg font-semibold mb-4" data-lang-key="confirm_action">Confirm Action</h3>
            <p id="modalMessage" class="mb-4"></p>
            <div class="flex justify-end space-x-2">
                <button id="cancelModalBtn" class="btn btn-cancel" data-lang-key="cancel">Cancel</button>
                <button id="confirmModalBtn" class="btn" data-lang-key="confirm">Confirm</button>
            </div>
        </div>

        <script>
            // --- Sound System ---
            let audioCtx;
            const sounds = {};

            function initAudio() {
                if (audioCtx) return;
                try {
                    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                    sounds.toggle = createTone(200, 0.1, 'square');
                    sounds.open = createTone(300, 0.1, 'sine');
                    sounds.close = createTone(150, 0.1, 'triangle');
                    sounds.confirm = createTone(440, 0.15, 'sine');
                    sounds.win = createTone(600, 0.2, 'triangle');
                    sounds.loss = createTone(120, 0.3, 'sawtooth');
                } catch (e) {
                    console.error("Web Audio API is not supported in this browser");
                }
            }

            function createTone(freq, duration, type) {
                return () => {
                    if (!audioCtx || !isSoundEnabled) return;
                    const oscillator = audioCtx.createOscillator();
                    const gainNode = audioCtx.createGain();
                    oscillator.connect(gainNode);
                    gainNode.connect(audioCtx.destination);
                    oscillator.type = type;
                    oscillator.frequency.setValueAtTime(freq, audioCtx.currentTime);
                    gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + duration);
                    oscillator.start(audioCtx.currentTime);
                    oscillator.stop(audioCtx.currentTime + duration);
                };
            }

            function playSound(type) {
                if (!sounds[type]) return;
                sounds[type]();
            }

            // --- Global State & Config ---
            let isSoundEnabled = localStorage.getItem('sound') === null ? true : localStorage.getItem('sound') === 'true';
            
            const translations = {
                en: {
                    period: "Period",
                    prediction: "Prediction",
                    confidence: "Confidence",
                    analysis_dashboard: "Analysis Dashboard",
                    win_rate: "Win Rate",
                    wins: "Wins",
                    losses: "Losses",
                    server_status: "Server Status",
                    connected: "Connected",
                    disconnected: "API Error",
                    history: "History",
                    delete: "Delete",
                    statistics: "Statistics",
                    total_wins: "Total Wins",
                    total_losses: "Total Losses",
                    about: "About", 
                    predictor_intro_title: "Our Prediction Engine",
                    predictor_intro_p1: "SEROX X AI employs a sophisticated prediction engine designed to analyze trends and patterns from historical data. Our goal is to provide insightful predictions, but it's important to remember that these are based on statistical analysis and not guarantees of future outcomes.",
                    privacy_policy_title: "Privacy Policy & Disclaimer",
                    review_terms: "Review our terms and data policies.",
                    view_policy: "View Policy",
                    privacy_policy_p1: "<strong>1. Data Collection:</strong> We do not collect, store, or share any personal user data. All settings and history are stored locally on your device's browser. Clearing your browser's cache will permanently delete this information.",
                    privacy_policy_p2: "<strong>2. Use of Predictions:</strong> The predictions generated by SEROX X AI are for informational and entertainment purposes only. They are based on algorithmic analysis of historical data and are not guaranteed to be accurate.",
                    privacy_policy_p3: "<strong>3. Financial Risk:</strong> We are not responsible for any financial losses incurred as a result of using our predictions. The user assumes full responsibility for any actions taken based on the information provided by this tool. Past performance is not an indicator of future results.",
                    privacy_policy_p4: "<strong>4. Responsible Use:</strong> Please use this tool responsibly and be aware of the risks involved. Do not use this tool for any illegal activities.",
                    meet_the_team_title: "Meet The Team",
                    owner_dev_info: "<strong>Owner & Developer:</strong> @SEROXAI",
                    contact_telegram: "Telegram Profile",
                    confirm_action: "Confirm Action",
                    cancel: "Cancel",
                    confirm: "Confirm",
                    pending: "Pending",
                    win: "Win",
                    loss: "Loss",
                    delete_item_confirm: "Are you sure you want to delete this history item?",
                    delete_all_confirm: "Are you sure you want to delete all history items?",
                    home: "Home",
                    stats: "Stats",
                    current_logic: "Current Logic",
                    logic_1: "Logic 1",
                    logic_2: "Logic 2",
                }
            };

            // --- DOM Elements ---
            const currentPeriodEl = document.getElementById('currentPeriod');
            const currentResultEl = document.getElementById('currentResult');
            const confidenceFillEl = document.getElementById('confidenceFill');
            const confidenceTextEl = document.getElementById('confidenceText');
            const winRateEl = document.getElementById('winRate');
            const totalWinBetsEl = document.getElementById('totalWinBets');
            const totalLossBetsEl = document.getElementById('totalLossBets');
            const serverStatusEl = document.getElementById('serverStatus');
            const serverStatusIndicator = document.getElementById('serverStatusIndicator');
            const historyContainer = document.getElementById('history');
            const statsTotalWinsEl = document.getElementById('statsTotalWins');
            const statsTotalLossesEl = document.getElementById('statsTotalLosses');
            const statsWinRateEl = document.getElementById('statsWinRate');
            const recentResultsContainer = document.getElementById('recentResultsContainer');
            const currentLogicDisplayEl = document.getElementById('currentLogicDisplay');
            const confirmModalEl = document.getElementById('confirmModal');
            const modalMessageEl = document.getElementById('modalMessage');
            const privacyModalEl = document.getElementById('privacyModal');

            // --- Application State ---
            let appHistory = JSON.parse(localStorage.getItem('seroxAppHistory')) || [];
            let recentResults = JSON.parse(localStorage.getItem('seroxRecentResults')) || [];
            let lastFetchedPeriod = localStorage.getItem('seroxLastFetchedPeriod') || null;
            let currentLogic = localStorage.getItem('seroxCurrentLogic') || 'LOGIC_1';

            // --- Core Prediction Logic ---

            /**
             * Fetches the latest game result from the API.
             * @returns {Promise<object|null>} The latest result object or null on error.
             */
            const fetchGameResult = async () => {
                try {
                    const response = await fetch("https://api.bdg88zf.com/api/webapi/GetNoaverageEmerdList", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({
                            pageSize: 10,
                            pageNo: 1,
                            typeId: 1,
                            language: 0,
                            random: "4a0522c6ecd8410496260e686be2a57c",
                            signature: "334B5E70A0C9B8918B0B15E517E2069C",
                            timestamp: Math.floor(Date.now() / 1000)
                        })
                    });

                    if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
                    
                    updateServerStatus(true);
                    const data = await response.json();
                    const latestResult = data?.data?.list?.[0];
                    
                    return latestResult ? { 
                        period: latestResult.issueNumber, 
                        result: latestResult.number 
                    } : null;
                } catch (error) {
                    console.error("Error fetching game result:", error);
                    updateServerStatus(false);
                    return null;
                }
            };
            
            /**
             * Determines if a number is BIG or SMALL.
             * @param {number|string} number The number to check.
             * @returns {string} 'BIG' or 'SMALL'.
             */
            const getNumberSize = (number) => (parseInt(number, 10) >= 5 ? 'BIG' : 'SMALL');

            /**
             * Generates a prediction based on the frequency of BIG/SMALL in the last two results.
             * @param {Array<object>} results - Array of recent result objects.
             * @returns {string} 'BIG' or 'SMALL'.
             */
            const generatePredictionLogic1 = (results) => {
                if (results.length < 2) return 'BIG'; // Default prediction
                const lastTwo = results.slice(0, 2);
                const bigCount = lastTwo.filter(r => r.size === 'BIG').length;
                return bigCount >= 1 ? 'BIG' : 'SMALL';
            };

            /**
             * Generates a prediction based on a fixed pattern map of the last 6 results.
             * @param {Array<object>} results - Array of recent result objects.
             * @returns {string} 'BIG' or 'SMALL'.
             */
            const generatePredictionLogic2 = (results) => {
                if (results.length < 6) return 'BIG'; // Default if not enough data
                const lastSix = results.slice(0, 6);
                const pattern = lastSix.map(r => r.size === 'BIG' ? '1' : '2').join('');
                const patternMap = {
                    '111111': 'BIG', '111112': 'BIG', '111121': 'BIG', '111122': 'BIG',
                    '111211': 'SMALL', '111212': 'SMALL', '111221': 'SMALL', '111222': 'SMALL',
                    '112111': 'SMALL', '112112': 'SMALL', '112121': 'SMALL', '112122': 'SMALL',
                    '112211': 'SMALL', '112212': 'SMALL', '112221': 'SMALL', '112222': 'BIG',
                    '121111': 'SMALL', '121112': 'SMALL', '121121': 'SMALL', '121122': 'SMALL',
                    '121211': 'SMALL', '121212': 'SMALL', '121221': 'SMALL', '121222': 'BIG',
                    '122111': 'SMALL', '122112': 'SMALL', '122121': 'SMALL', '122122': 'BIG',
                    '122211': 'SMALL', '122212': 'BIG', '122221': 'BIG', '122222': 'BIG',
                    '211111': 'SMALL', '211112': 'SMALL', '211121': 'SMALL', '211122': 'SMALL',
                    '211211': 'SMALL', '211212': 'SMALL', '211221': 'BIG', '211222': 'BIG',
                    '212111': 'SMALL', '212112': 'SMALL', '212121': 'SMALL', '212122': 'BIG',
                    '212211': 'SMALL', '212212': 'BIG', '212221': 'SMALL', '212222': 'BIG',
                    '221111': 'SMALL', '221112': 'SMALL', '221121': 'SMALL', '221122': 'BIG',
                    '221211': 'SMALL', '221212': 'BIG', '221221': 'BIG', '221222': 'BIG',
                    '222111': 'SMALL', '222112': 'BIG', '222121': 'SMALL', '222122': 'BIG',
                    '222211': 'SMALL', '222212': 'SMALL', '222221': 'SMALL', '222222': 'SMALL'
                };

                return patternMap[pattern] || (results[0].size === 'BIG' ? 'SMALL' : 'BIG');
            };


            // --- Main Application Loop ---
            
            /**
             * The main function that updates predictions and UI.
             */
            const updatePrediction = async () => {
                const apiResult = await fetchGameResult();

                if (apiResult && apiResult.period !== lastFetchedPeriod) {
                    lastFetchedPeriod = apiResult.period;
                    const nextPeriod = (BigInt(apiResult.period) + 1n).toString();
                    
                    const newRecentResult = {
                        period: apiResult.period,
                        number: apiResult.result,
                        size: getNumberSize(apiResult.result)
                    };
                    
                    // Update recent results list
                    recentResults.unshift(newRecentResult);
                    if (recentResults.length > 15) recentResults.pop();
                    
                    // Find pending prediction and update status
                    const pendingIndex = appHistory.findIndex(item => item.status === 'Pending');
                    if (pendingIndex > -1) {
                        const pendingItem = appHistory[pendingIndex];
                        const actualSize = getNumberSize(apiResult.result);
                        const isWin = pendingItem.prediction === actualSize;
                        
                        pendingItem.status = isWin ? 'Win' : 'Loss';
                        pendingItem.actual = apiResult.result;

                        if (isWin) {
                            playSound('win');
                        } else {
                            playSound('loss');
                            // Switch logic on loss
                            currentLogic = currentLogic === 'LOGIC_1' ? 'LOGIC_2' : 'LOGIC_1';
                        }
                    }

                    // Generate new prediction
                    let newPrediction;
                    if (currentLogic === 'LOGIC_1') {
                        newPrediction = generatePredictionLogic1(recentResults);
                    } else {
                        newPrediction = generatePredictionLogic2(recentResults);
                    }

                    // Add new pending item to history
                    appHistory.unshift({
                        period: nextPeriod,
                        prediction: newPrediction,
                        status: 'Pending',
                        logicUsed: currentLogic,
                        actual: null
                    });

                    // Persist state
                    localStorage.setItem('seroxAppHistory', JSON.stringify(appHistory));
                    localStorage.setItem('seroxRecentResults', JSON.stringify(recentResults));
                    localStorage.setItem('seroxLastFetchedPeriod', lastFetchedPeriod);
                    localStorage.setItem('seroxCurrentLogic', currentLogic);

                    // Update UI
                    updateUI();
                }
            };

            // --- UI Update Functions ---
            
            /**
             * Updates all UI elements with the latest state.
             */
            function updateUI() {
                // Main prediction display
                const pendingPrediction = appHistory.find(item => item.status === 'Pending');
                if (pendingPrediction) {
                    currentPeriodEl.textContent = pendingPrediction.period.slice(-4);
                    currentResultEl.textContent = pendingPrediction.prediction;
                    currentResultEl.style.color = pendingPrediction.prediction === 'BIG' ? '#8E44AD' : '#D91B5C';
                } else {
                    currentPeriodEl.textContent = '-';
                    currentResultEl.textContent = '-';
                }

                // Stats calculation
                const wins = appHistory.filter(item => item.status === 'Win').length;
                const losses = appHistory.filter(item => item.status === 'Loss').length;
                const total = wins + losses;
                const winRate = total > 0 ? ((wins / total) * 100).toFixed(2) : 0;
                
                // Dashboard update
                winRateEl.textContent = `${winRate}%`;
                totalWinBetsEl.textContent = wins;
                totalLossBetsEl.textContent = losses;
                currentLogicDisplayEl.textContent = currentLogic === 'LOGIC_1' ? 'Logic 1' : 'Logic 2';
                
                // Stats page update
                statsTotalWinsEl.textContent = wins;
                statsTotalLossesEl.textContent = losses;
                statsWinRateEl.textContent = `${winRate}%`;
                
                // Confidence (dummy value for now)
                const confidence = 85 + Math.floor(Math.random() * 15); // Random confidence
                confidenceFillEl.style.width = `${confidence}%`;
                confidenceTextEl.textContent = `${confidence}%`;

                updateHistoryUI();
                updateRecentResultsUI();
            }
            
            /**
             * Renders the prediction history list.
             */
            function updateHistoryUI() {
                historyContainer.innerHTML = '';
                if (appHistory.length === 0) {
                    historyContainer.innerHTML = `<div class="text-center p-4 card !m-0"><p>No history yet.</p></div>`;
                    return;
                }

                appHistory.slice(0, 20).forEach((entry, index) => { // Show max 20 entries
                    const status = (entry.status || 'pending').toLowerCase();
                    const iconClass = { win: 'fas fa-check-circle', loss: 'fas fa-times-circle', pending: 'fas fa-hourglass-half'}[status] || 'fas fa-question-circle';
                    const badgeClass = { win: 'win-icon', loss: 'loss-icon', pending: 'pending-icon'}[status] || '';

                    const historyItem = document.createElement('div');
                    historyItem.className = `history-item card !m-0 ${status} flex items-center justify-between p-4 rounded-xl animate__animated animate__fadeInUp animate__faster`;
                    historyItem.style.animationDelay = `${index * 0.05}s`;
                    
                    const predictionText = `Pred: <strong>${entry.prediction || '-'}</strong>`;
                    const actualText = entry.actual !== null ? `Actual: <strong>${entry.actual} (${getNumberSize(entry.actual)})</strong>` : '';
                    const logicText = `Logic: <strong>${entry.logicUsed === 'LOGIC_1' ? '1' : '2'}</strong>`;
                    
                    historyItem.innerHTML = `
                        <div class="flex items-center space-x-3 flex-grow">
                            <div class="status-icon ${badgeClass}"><i class="${iconClass}"></i></div>
                            <div class="flex-grow">
                                <p class="text-lg font-semibold">#${entry.period.slice(-4)}</p>
                                <div class="flex flex-wrap text-sm gap-x-3 opacity-90">
                                    <span>${predictionText}</span>
                                    <span>${actualText}</span>
                                    <span>${logicText}</span>
                                </div>
                            </div>
                        </div>
                        <button class="delete-btn text-gray-400 hover:text-D91B5C transition ml-2 p-2 rounded-full" data-period="${entry.period}">
                           <i class="fas fa-trash-alt text-lg"></i>
                        </button>`;
                    
                    historyContainer.appendChild(historyItem);
                });
                
                 // Add event listeners for delete buttons
                historyContainer.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const periodToDelete = e.currentTarget.getAttribute('data-period');
                        showConfirmModal('delete_item_confirm', () => {
                            appHistory = appHistory.filter(item => item.period !== periodToDelete);
                            localStorage.setItem('seroxAppHistory', JSON.stringify(appHistory));
                            updateUI();
                            playSound('confirm');
                        });
                    });
                });
            }
            
            /**
             * Renders the recent results bubbles.
             */
            function updateRecentResultsUI() {
                recentResultsContainer.innerHTML = '';
                recentResults.forEach(result => {
                    const size = getNumberSize(result.number);
                    const colorClass = size === 'BIG' ? 'bg-purple-500' : 'bg-pink-500';
                    const resultEl = document.createElement('div');
                    resultEl.className = 'flex flex-col items-center';
                    resultEl.innerHTML = `
                      <div class="text-xs text-gray-400 mb-1">#${result.period.slice(-4)}</div>
                      <div class="w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold ${size === 'BIG' ? 'bg-[#8E44AD]' : 'bg-[#D91B5C]'}">
                        ${result.number}
                      </div>
                      <div class="text-xs mt-1 font-bold">${size}</div>
                    `;
                    recentResultsContainer.appendChild(resultEl);
                });
            }
            
            function updateServerStatus(isConnected, message = null) {
                if (isConnected) {
                    serverStatusEl.textContent = message || translations.en.connected;
                    serverStatusIndicator.classList.remove('bg-red-500'); 
                    serverStatusIndicator.classList.add('animate-ping', 'bg-90EE90'); 
                } else {
                    serverStatusEl.textContent = message || translations.en.disconnected;
                    serverStatusIndicator.classList.remove('animate-ping', 'bg-90EE90');
                    serverStatusIndicator.classList.add('bg-red-500');
                }
            }


            // --- Navigation & Modal Logic ---
            const navItems = document.querySelectorAll('.navigation ul li');
            const sections = document.querySelectorAll('.content-section');
            const indicator = document.querySelector('.indicator');

            navItems.forEach((item, index) => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    navItems.forEach(nav => nav.classList.remove('active'));
                    item.classList.add('active');
                    indicator.style.transform = `translateX(calc(75px * ${index}))`;
                    const sectionId = item.querySelector('a').getAttribute('data-section');
                    sections.forEach(section => section.classList.remove('active'));
                    document.getElementById(sectionId)?.classList.add('active');
                    playSound('toggle');
                });
            });
            
            let currentConfirmCallback = null;
            function showConfirmModal(messageKey, onConfirm) {
                modalMessageEl.textContent = translations.en[messageKey] || "Are you sure?";
                confirmModalEl.classList.add('active');
                currentConfirmCallback = onConfirm;
                playSound('open');
            }
            
            document.getElementById('confirmModalBtn').addEventListener('click', () => {
                if (currentConfirmCallback) currentConfirmCallback();
                confirmModalEl.classList.remove('active');
                playSound('confirm');
                currentConfirmCallback = null;
            });

            document.getElementById('cancelModalBtn').addEventListener('click', () => {
                confirmModalEl.classList.remove('active');
                playSound('close');
                currentConfirmCallback = null;
            });
            
            document.getElementById('privacyBtn').addEventListener('click', () => {
                privacyModalEl.classList.add('active');
                playSound('open');
            });
            
            document.getElementById('closePrivacyModalBtn').addEventListener('click', () => {
                privacyModalEl.classList.remove('active');
                playSound('close');
            });
            
            document.getElementById('deleteAllHistoryBtn').addEventListener('click', () => {
                showConfirmModal('delete_all_confirm', () => {
                    appHistory = [];
                    localStorage.removeItem('seroxAppHistory');
                    updateUI();
                    playSound('confirm');
                });
            });

            // --- App Initialization ---
            function initializeApp() {
                updateUI(); // Initial UI render from saved state
                initAudio();
                updatePrediction(); // Fetch immediately on load
                setInterval(updatePrediction, 3000); // Then update every 3 seconds
            }

            document.addEventListener('DOMContentLoaded', initializeApp);

        </script>
</body>
</html>
